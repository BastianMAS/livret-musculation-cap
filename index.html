<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Livret Musculation CAP</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            min-height: 100vh;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0f172a 100%);
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 1rem; }
        .card { 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px);
            border-radius: 1.5rem; 
            padding: 2rem; 
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            margin-bottom: 1.5rem;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            font-size: 1rem;
        }
        .btn:hover { transform: scale(1.05); }
        .btn-primary { 
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            color: white;
        }
        .btn-success { 
            background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%);
            color: white;
        }
        .btn-secondary { 
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        .btn-danger { 
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
        }
        .btn-warning {
            background: linear-gradient(135deg, #f97316 0%, #fb923c 100%);
            color: white;
        }
        .btn-link {
            background: transparent;
            color: #67e8f9;
            text-decoration: underline;
            padding: 0.5rem;
            font-size: 0.875rem;
        }
        .input {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        .input::placeholder { color: rgba(255, 255, 255, 0.5); }
        .input:focus { outline: none; border-color: #06b6d4; }
        select.input { 
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='white' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1rem;
            padding-right: 2.5rem;
        }
        .text-white { color: white; }
        .text-cyan { color: #67e8f9; }
        .text-center { text-align: center; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-4 { margin-bottom: 2rem; }
        .mt-2 { margin-top: 1rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 1rem; }
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-5 { grid-template-columns: repeat(5, 1fr); }
        .hidden { display: none; }
        .muscle-btn {
            padding: 0.75rem;
            border-radius: 0.75rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            transition: all 0.2s;
            font-size: 0.85rem;
        }
        .muscle-btn.active {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            color: white;
            transform: scale(1.05);
        }
        .session-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
        }
        .session-card:hover { background: rgba(255, 255, 255, 0.15); }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .badge-force { background: linear-gradient(135deg, #f97316 0%, #fb923c 100%); color: white; }
        .badge-endurance { background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%); color: white; }
        .badge-equilibre { background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%); color: white; }
        .lock-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }
        .tab-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
        }
        .tab-btn.active {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            color: white;
        }
        .rm-result {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(20, 184, 166, 0.2) 100%);
            border: 2px solid rgba(16, 185, 129, 0.5);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            margin: 1.5rem 0;
        }
        
        .sub-tab-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }
        .sub-tab-btn.active {
            background: rgba(6, 182, 212, 0.3);
            color: white;
        }
        
        .content-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .exercise-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .exercise-card h4 {
            color: #67e8f9;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }
        
        .exercise-card ul {
            list-style: none;
            padding-left: 0;
        }
        
        .exercise-card li {
            color: rgba(255, 255, 255, 0.85);
            padding: 0.4rem 0;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .exercise-card li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #06b6d4;
        }
        
        .tip-box {
            background: rgba(16, 185, 129, 0.15);
            border-left: 4px solid #10b981;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .warning-box {
            background: rgba(251, 146, 60, 0.15);
            border-left: 4px solid #fb923c;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }

        .circuit-exercise {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .radio-group {
            display: flex;
            gap: 1rem;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            cursor: pointer;
        }

        .radio-label input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .anatomy-image-container {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 1rem;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .anatomy-image-container img {
            width: 100%;
            height: auto;
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .anatomy-image-placeholder {
            background: rgba(6, 182, 212, 0.1);
            border: 2px dashed rgba(6, 182, 212, 0.4);
            border-radius: 0.75rem;
            padding: 3rem 1rem;
            color: #67e8f9;
            font-size: 0.9rem;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .muscle-info-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border-left: 4px solid #06b6d4;
        }
        
        .muscle-info-card h4 {
            color: #67e8f9;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .muscle-info-section {
            margin-top: 0.75rem;
        }
        
        .muscle-info-section h5 {
            color: #10b981;
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .muscle-info-section p {
            color: rgba(255, 255, 255, 0.85);
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }
        
        .muscle-info-section ul {
            list-style: none;
            padding-left: 0;
        }
        
        .muscle-info-section li {
            color: rgba(255, 255, 255, 0.85);
            padding: 0.3rem 0;
            padding-left: 1.5rem;
            position: relative;
            line-height: 1.5;
        }
        
        .muscle-info-section li:before {
            content: "‚Ä¢";
            position: absolute;
            left: 0.5rem;
            color: #06b6d4;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>// Donn√©es des cours et exercices
        const coursData = {
            principes: [
                {
                    titre: "Progression Progressive",
                    contenu: "Augmentez graduellement la charge, le volume ou l'intensit√© pour continuer √† progresser. Visez une augmentation de 2-5% par semaine.",
                    conseils: [
                        "Augmentez d'abord les r√©p√©titions avant d'augmenter la charge",
                        "Tenez un journal d'entra√Ænement",
                        "Soyez patient, la progression prend du temps"
                    ]
                },
                {
                    titre: "R√©cup√©ration Ad√©quate",
                    contenu: "Le muscle se construit pendant le repos, pas pendant l'entra√Ænement. Respectez 48-72h de repos entre deux s√©ances pour le m√™me groupe musculaire.",
                    conseils: [
                        "Dormez 7-9 heures par nuit",
                        "Hydratez-vous bien",
                        "Mangez suffisamment de prot√©ines (1.6-2.2g/kg)"
                    ]
                },
                {
                    titre: "Technique Avant Charge",
                    contenu: "Une bonne technique pr√©vient les blessures et maximise les gains. Ma√Ætrisez le mouvement avant d'augmenter la charge.",
                    conseils: [
                        "Filmez-vous pour v√©rifier votre technique",
                        "N'h√©sitez pas √† diminuer la charge si n√©cessaire",
                        "Concentrez-vous sur le muscle cibl√©"
                    ]
                }
            ],
            exercicesPectoraux: [
                {
                    nom: "D√©velopp√© couch√©",
                    description: "Exercice de base pour les pectoraux",
                    technique: [
                        "Allongez-vous sur le banc, pieds au sol",
                        "Saisissez la barre l√©g√®rement plus large que les √©paules",
                        "Descendez la barre vers le bas des pectoraux",
                        "Poussez en contractant les pectoraux"
                    ],
                    variantes: ["D√©velopp√© inclin√©", "D√©velopp√© d√©clin√©", "D√©velopp√© avec halt√®res"]
                },
                {
                    nom: "Pompes",
                    description: "Exercice au poids du corps tr√®s efficace",
                    technique: [
                        "Position de planche, mains sous les √©paules",
                        "Descendez le corps en gardant le dos droit",
                        "Remontez en poussant fort",
                        "Gardez les abdos gain√©s"
                    ],
                    variantes: ["Pompes sur√©lev√©es", "Pompes d√©clin√©es", "Pompes diamant"]
                },
                {
                    nom: "√âcart√© aux halt√®res",
                    description: "Excellent pour l'√©tirement des pectoraux",
                    technique: [
                        "Allong√© sur un banc, halt√®res au-dessus de la poitrine",
                        "√âcartez les bras en gardant une l√©g√®re flexion des coudes",
                        "Descendez jusqu'√† sentir l'√©tirement",
                        "Remontez en contractant les pectoraux"
                    ],
                    variantes: ["√âcart√© inclin√©", "√âcart√© √† la poulie"]
                }
            ],
            exercicesDos: [
                {
                    nom: "Tractions",
                    description: "Le roi des exercices pour le dos",
                    technique: [
                        "Suspendez-vous √† une barre, mains en pronation",
                        "Tirez jusqu'√† ce que le menton d√©passe la barre",
                        "Contractez les omoplates en haut du mouvement",
                        "Descendez de mani√®re contr√¥l√©e"
                    ],
                    variantes: ["Tractions supination", "Tractions neutres", "Tractions assist√©es"]
                },
                {
                    nom: "Rowing barre",
                    description: "D√©veloppe l'√©paisseur du dos",
                    technique: [
                        "Penchez-vous en avant, dos droit",
                        "Tirez la barre vers le bas des abdos",
                        "Serrez les omoplates en haut",
                        "Gardez les coudes pr√®s du corps"
                    ],
                    variantes: ["Rowing halt√®re", "Rowing T-bar", "Rowing Yates"]
                },
                {
                    nom: "Soulev√© de terre",
                    description: "Exercice complet pour tout le dos",
                    technique: [
                        "Pieds √©cart√©s largeur des hanches",
                        "Saisissez la barre, dos droit",
                        "Poussez avec les jambes puis tendez le dos",
                        "Gardez la barre proche du corps"
                    ],
                    variantes: ["Soulev√© de terre roumain", "Soulev√© de terre sumo"]
                }
            ],
            exercicesEpaules: [
                {
                    nom: "D√©velopp√© militaire",
                    description: "Base pour les delto√Ødes",
                    technique: [
                        "Debout ou assis, barre devant les √©paules",
                        "Poussez verticalement au-dessus de la t√™te",
                        "Gardez les abdos gain√©s",
                        "Descendez de mani√®re contr√¥l√©e"
                    ],
                    variantes: ["D√©velopp√© Arnold", "D√©velopp√© nuque", "D√©velopp√© avec halt√®res"]
                },
                {
                    nom: "√âl√©vations lat√©rales",
                    description: "Cible les delto√Ødes moyens",
                    technique: [
                        "Debout, halt√®res le long du corps",
                        "√âlevez les bras sur les c√¥t√©s jusqu'√† l'horizontale",
                        "Gardez une l√©g√®re flexion des coudes",
                        "Contr√¥lez la descente"
                    ],
                    variantes: ["√âl√©vations √† la poulie", "√âl√©vations pench√©es"]
                }
            ],
            exercicesBras: [
                {
                    nom: "Curl biceps barre",
                    description: "Exercice de base pour les biceps",
                    technique: [
                        "Debout, barre en supination",
                        "Fl√©chissez les coudes sans bouger les √©paules",
                        "Contractez en haut",
                        "Descendez lentement"
                    ],
                    variantes: ["Curl halt√®res", "Curl marteau", "Curl pupitre"]
                },
                {
                    nom: "Dips",
                    description: "Excellent pour les triceps",
                    technique: [
                        "Mains sur les barres parall√®les",
                        "Descendez en fl√©chissant les coudes",
                        "Gardez le buste l√©g√®rement pench√© en avant",
                        "Poussez jusqu'√† l'extension compl√®te"
                    ],
                    variantes: ["Dips lest√©s", "Dips sur banc"]
                },
                {
                    nom: "Extension triceps",
                    description: "Isole les triceps",
                    technique: [
                        "Allong√©, barre au-dessus du front",
                        "Descendez vers le front en fl√©chissant uniquement les coudes",
                        "Remontez en contractant les triceps",
                        "Gardez les coudes fixes"
                    ],
                    variantes: ["Extension poulie haute", "Extension nuque"]
                }
            ],
            exercicesJambes: [
                {
                    nom: "Squat",
                    description: "Le roi des exercices pour les jambes",
                    technique: [
                        "Barre sur les trap√®zes, pieds largeur des √©paules",
                        "Descendez en poussant les fesses en arri√®re",
                        "Allez au moins jusqu'√† la parall√®le",
                        "Poussez en gardant les talons au sol"
                    ],
                    variantes: ["Squat avant", "Squat bulgare", "Goblet squat"]
                },
                {
                    nom: "Fentes",
                    description: "Excellent pour quadriceps et fessiers",
                    technique: [
                        "Faites un grand pas en avant",
                        "Descendez le genou arri√®re vers le sol",
                        "Le genou avant ne d√©passe pas les orteils",
                        "Poussez sur le talon avant pour remonter"
                    ],
                    variantes: ["Fentes march√©es", "Fentes bulgares", "Fentes saut√©es"]
                },
                {
                    nom: "Leg curl",
                    description: "Isole les ischio-jambiers",
                    technique: [
                        "Allong√© sur la machine, chevilles sous le boudin",
                        "Fl√©chissez les jambes vers les fessiers",
                        "Contractez en haut",
                        "Descendez lentement"
                    ],
                    variantes: ["Leg curl debout", "Leg curl assis"]
                }
            ],
            exercicesAbdos: [
                { nom: "Crunch", description: "Classique pour le grand droit" },
                { nom: "Planche", description: "Gainage statique" },
                { nom: "Russian twist", description: "Pour les obliques" },
                { nom: "Lev√©e de jambes", description: "Bas des abdos" },
                { nom: "Mountain climbers", description: "Cardio et abdos" },
                { nom: "Bicycle crunch", description: "Obliques dynamiques" },
                { nom: "Dead bug", description: "Stabilit√© du core" },
                { nom: "Hollow hold", description: "Gainage avanc√©" }
            ],
            anatomie: {
                "Pectoraux": {
                    role: "Les pectoraux sont les muscles principaux de la poitrine. Ils permettent l'adduction (rapprochement du bras vers le corps), la flexion de l'√©paule et la rotation interne du bras. Ils sont essentiels dans les mouvements de pouss√©e.",
                    insertions: [
                        "Origine : Clavicule (faisceau claviculaire), sternum et cartilages costaux (faisceau sterno-costal)",
                        "Terminaison : L√®vre lat√©rale de la goutti√®re bicipitale de l'hum√©rus",
                        "Le grand pectoral se divise en 3 faisceaux : claviculaire (haut), sternal (milieu) et abdominal (bas)"
                    ]
                },
                "Grand dorsal": {
                    role: "Le plus large muscle du dos, il permet l'extension, l'adduction et la rotation interne du bras. Il est le muscle principal dans les mouvements de tirage vertical (tractions) et contribue √† la stabilit√© de l'√©paule.",
                    insertions: [
                        "Origine : Processus √©pineux des 6 derni√®res vert√®bres thoraciques, toutes les vert√®bres lombaires, cr√™te sacr√©e, cr√™te iliaque et 3-4 derni√®res c√¥tes",
                        "Terminaison : Goutti√®re bicipitale de l'hum√©rus (sillon inter-tuberculaire)",
                        "Forme une large bande musculaire en forme de V dans le dos"
                    ]
                },
                "Trap√®zes": {
                    role: "Muscle superficiel du dos en forme de trap√®ze, il permet l'√©l√©vation, l'abaissement et la r√©traction des omoplates. Il stabilise √©galement l'√©paule lors des mouvements du bras et soutient le port de charges.",
                    insertions: [
                        "Origine : Ligament nuchal, processus √©pineux de C7 √† T12, protub√©rance occipitale externe",
                        "Terminaison : Tiers lat√©ral de la clavicule (faisceau sup√©rieur), acromion et √©pine de la scapula (faisceau moyen et inf√©rieur)",
                        "Se divise en 3 faisceaux : sup√©rieur, moyen et inf√©rieur avec des actions diff√©rentes"
                    ]
                },
                "Delto√Ødes": {
                    role: "Muscle de l'√©paule formant son galbe arrondi. Il permet l'abduction (√©l√©vation lat√©rale), la flexion (faisceau ant√©rieur) et l'extension (faisceau post√©rieur) du bras. C'est le muscle principal pour tous les mouvements de l'√©paule.",
                    insertions: [
                        "Origine : Tiers lat√©ral de la clavicule (ant√©rieur), acromion (moyen), √©pine de la scapula (post√©rieur)",
                        "Terminaison : Tub√©rosit√© delto√Ødienne de l'hum√©rus (face lat√©rale)",
                        "Se compose de 3 faisceaux distincts : ant√©rieur, moyen (lat√©ral) et post√©rieur"
                    ]
                },
                "Biceps": {
                    role: "Muscle √† deux chefs situ√© √† l'avant du bras. Il permet la flexion du coude et la supination de l'avant-bras (rotation de la paume vers le haut). Il assiste aussi la flexion de l'√©paule.",
                    insertions: [
                        "Origine : Apophyse coraco√Øde (chef court) et tubercule supra-gl√©no√Ødien de la scapula (chef long)",
                        "Terminaison : Tub√©rosit√© radiale et apon√©vrose bicipitale (lacertus fibrosus)",
                        "Deux chefs distincts (long et court) qui fusionnent en un seul tendon distal"
                    ]
                },
                "Triceps": {
                    role: "Muscle √† trois chefs situ√© √† l'arri√®re du bras. Il permet l'extension du coude et l'extension de l'√©paule (chef long). C'est le seul muscle extenseur du coude et il repr√©sente 2/3 de la masse du bras.",
                    insertions: [
                        "Origine : Tubercule infra-gl√©no√Ødien de la scapula (chef long), face post√©rieure de l'hum√©rus au-dessus et au-dessous du sillon radial (chefs lat√©ral et m√©dial)",
                        "Terminaison : Ol√©cr√¢ne de l'ulna via un tendon commun",
                        "Trois chefs : long (traverse l'√©paule), lat√©ral (externe) et m√©dial (profond)"
                    ]
                },
                "Abdominaux": {
                    role: "Groupe musculaire de la paroi abdominale ant√©rieure. Ils permettent la flexion du tronc, la rotation et l'inclinaison lat√©rale. Ils prot√®gent les organes internes, stabilisent le bassin et participent √† la respiration et √† l'augmentation de la pression abdominale.",
                    insertions: [
                        "Grand droit : Cr√™te pubienne (origine) ‚Üí Cartilages costaux 5-7 et processus xipho√Øde (terminaison)",
                        "Obliques externes : 8 derni√®res c√¥tes ‚Üí Cr√™te iliaque et ligne blanche",
                        "Obliques internes : Cr√™te iliaque ‚Üí Cartilages costaux inf√©rieurs et ligne blanche",
                        "Transverse : Cartilages costaux, fascia thoraco-lombaire, cr√™te iliaque ‚Üí Ligne blanche (muscle le plus profond)"
                    ]
                },
                "Quadriceps": {
                    role: "Le plus volumineux et puissant muscle du corps humain, situ√© √† l'avant de la cuisse. Il permet l'extension du genou et la flexion de la hanche (droit f√©moral). C'est le muscle principal de la marche, de la course et des sauts.",
                    insertions: [
                        "Origine : √âpine iliaque ant√©ro-inf√©rieure (droit f√©moral), grand trochanter et ligne √¢pre du f√©mur (vaste lat√©ral et m√©dial), face ant√©rieure du f√©mur (vaste interm√©diaire)",
                        "Terminaison : Tub√©rosit√© tibiale via le tendon patellaire (passe par la rotule)",
                        "Compos√© de 4 chefs : droit f√©moral, vaste lat√©ral, vaste m√©dial et vaste interm√©diaire"
                    ]
                },
                "Ischio-jambiers": {
                    role: "Groupe musculaire situ√© √† l'arri√®re de la cuisse. Ils permettent l'extension de la hanche et la flexion du genou. Ils sont essentiels pour la course, le saut et la d√©c√©l√©ration. Muscle antagoniste du quadriceps.",
                    insertions: [
                        "Origine : Tub√©rosit√© ischiatique (semi-tendineux, semi-membraneux, chef long du biceps f√©moral) et ligne √¢pre du f√©mur (chef court du biceps f√©moral)",
                        "Terminaison : T√™te de la fibula (biceps f√©moral), face m√©diale du tibia (semi-tendineux et semi-membraneux)",
                        "Compos√© de 3 muscles : biceps f√©moral (2 chefs), semi-tendineux et semi-membraneux"
                    ]
                },
                "Fessiers": {
                    role: "Le groupe musculaire le plus puissant du corps, formant les fesses. Le grand fessier permet l'extension et la rotation lat√©rale de la hanche. Le moyen et petit fessier permettent l'abduction et stabilisent le bassin lors de la marche.",
                    insertions: [
                        "Grand fessier : Cr√™te iliaque, sacrum, coccyx ‚Üí Tub√©rosit√© glut√©ale du f√©mur et tractus ilio-tibial",
                        "Moyen fessier : Face externe de l'ilium ‚Üí Grand trochanter du f√©mur",
                        "Petit fessier : Face externe de l'ilium (sous le moyen fessier) ‚Üí Grand trochanter du f√©mur",
                        "Le grand fessier est le plus gros et superficiel, le moyen et petit sont plus profonds et lat√©raux"
                    ]
                },
                "Mollets": {
                    role: "Situ√©s √† l'arri√®re de la jambe, ils permettent la flexion plantaire (pointer les orteils) et participent √† la flexion du genou (gastrocn√©mien). Ils sont essentiels pour la marche, la course, le saut et l'√©quilibre. Muscles tr√®s sollicit√©s au quotidien.",
                    insertions: [
                        "Gastrocn√©mien (jumeau) : Condyles f√©moraux (2 chefs m√©dial et lat√©ral) ‚Üí Calcan√©um via le tendon d'Achille",
                        "Sol√©aire : Face post√©rieure du tibia et fibula ‚Üí Calcan√©um via le tendon d'Achille",
                        "Le gastrocn√©mien est superficiel (forme le galbe du mollet), le sol√©aire est profond et plus volumineux"
                    ]
                }
            }
        };

        // Syst√®me de stockage
        const storage = {
            save(key, value, global = false) {
                try {
                    const storageKey = global ? key : `${app.currentUser}-${key}`;
                    localStorage.setItem(storageKey, JSON.stringify(value));
                    return true;
                } catch (e) {
                    console.error('Storage error:', e);
                    return false;
                }
            },
            get(key, global = false) {
                try {
                    const storageKey = global ? key : `${app.currentUser}-${key}`;
                    const item = localStorage.getItem(storageKey);
                    return {
                        exists: item !== null,
                        value: item
                    };
                } catch (e) {
                    return { exists: false, value: null };
                }
            },
            remove(key, global = false) {
                try {
                    const storageKey = global ? key : `${app.currentUser}-${key}`;
                    localStorage.removeItem(storageKey);
                    return true;
                } catch (e) {
                    return false;
                }
            }
        };

        // Questions de s√©curit√©
        const securityQuestions = [
            "Quel est le nom de votre premier animal de compagnie ?",
            "Dans quelle ville √™tes-vous n√©(e) ?",
            "Quel est le nom de jeune fille de votre m√®re ?",
            "Quel √©tait votre surnom d'enfance ?",
            "Quel est le nom de votre √©cole primaire ?"
        ];class LivretApp {
            constructor() {
                this.currentUser = null;
                this.currentView = 'login';
                this.currentTab = 'dashboard';
                this.sessions = [];
                this.currentSession = null;
                this.musclesList = ['Pectoraux', 'Grand dorsal', 'Trap√®zes', 'Delto√Ødes', 'Biceps', 'Triceps', 'Abdominaux', 'Quadriceps', 'Ischio-jambiers', 'Fessiers', 'Mollets'];
                this.currentCoursTab = 'principes';
                this.init();
            }

            init() {
                this.loadSessions();
                this.render();
            }

            loadSessions() {
                if (!this.currentUser) return;
                const result = storage.get('sessions');
                if (result.exists) {
                    this.sessions = JSON.parse(result.value);
                }
            }

            saveSessions() {
                storage.save('sessions', this.sessions);
            }

            render() {
                const app = document.getElementById('app');
                
                if (this.currentView === 'login') {
                    app.innerHTML = this.renderLogin();
                    this.attachLoginEvents();
                } else if (this.currentView === 'signup') {
                    app.innerHTML = this.renderSignup();
                    this.attachLoginEvents();
                } else if (this.currentView === 'reset') {
                    app.innerHTML = this.renderPasswordReset();
                    this.attachResetEvents();
                } else if (this.currentView === 'dashboard') {
                    app.innerHTML = this.renderDashboard();
                    this.attachDashboardEvents();
                } else if (this.currentView === 'session-form') {
                    app.innerHTML = this.renderSessionForm();
                    this.attachSessionFormEvents();
                } else if (this.currentView === 'session-detail') {
                    app.innerHTML = this.renderSessionDetail();
                }
            }

            renderLogin() {
                return `
                    <div class="container">
                        <div class="card" style="max-width: 450px; margin: 4rem auto;">
                            <div class="text-center mb-4">
                                <div class="lock-icon" style="margin: 0 auto 1.5rem;">üîí</div>
                                <h1 class="text-white" style="font-size: 2rem; margin-bottom: 0.5rem;">Livret Musculation</h1>
                                <p class="text-cyan">CAP - Suivi personnalis√©</p>
                            </div>
                            
                            <form id="login-form">
                                <div class="mb-2">
                                    <label class="text-white mb-1" style="display: block;">Nom d'utilisateur</label>
                                    <input type="text" class="input" id="login-username" required>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="text-white mb-1" style="display: block;">Mot de passe</label>
                                    <input type="password" class="input" id="login-password" required>
                                </div>
                                
                                <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;">Se connecter</button>
                                
                                <div class="text-center">
                                    <button type="button" class="btn btn-link" onclick="app.showSignup()">Cr√©er un compte</button>
                                    <button type="button" class="btn btn-link" onclick="app.showPasswordReset()">Mot de passe oubli√© ?</button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;
            }

            renderSignup() {
                return `
                    <div class="container">
                        <div class="card" style="max-width: 450px; margin: 4rem auto;">
                            <div class="text-center mb-4">
                                <h1 class="text-white" style="font-size: 2rem; margin-bottom: 0.5rem;">Cr√©er un compte</h1>
                                <p class="text-cyan">Rejoignez le programme CAP</p>
                            </div>
                            
                            <form id="signup-form">
                                <div class="mb-2">
                                    <label class="text-white mb-1" style="display: block;">Nom d'utilisateur</label>
                                    <input type="text" class="input" id="signup-username" required>
                                </div>
                                
                                <div class="mb-2">
                                    <label class="text-white mb-1" style="display: block;">Mot de passe</label>
                                    <input type="password" class="input" id="signup-password" required>
                                </div>
                                
                                <div class="mb-2">
                                    <label class="text-white mb-1" style="display: block;">Confirmer le mot de passe</label>
                                    <input type="password" class="input" id="signup-password-confirm" required>
                                </div>
                                
                                <div class="mb-2">
                                    <label class="text-white mb-1" style="display: block;">Question de s√©curit√©</label>
                                    <select class="input" id="signup-security-question" required>
                                        <option value="">Choisissez une question...</option>
                                        ${securityQuestions.map((q, i) => `<option value="${i}">${q}</option>`).join('')}
                                    </select>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="text-white mb-1" style="display: block;">R√©ponse</label>
                                    <input type="text" class="input" id="signup-security-answer" required>
                                </div>
                                
                                <button type="submit" class="btn btn-success" style="width: 100%; margin-bottom: 1rem;">S'inscrire</button>
                                
                                <div class="text-center">
                                    <button type="button" class="btn btn-link" onclick="app.showLogin()">Retour √† la connexion</button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;
            }

            renderPasswordReset() {
                return `
                    <div class="container">
                        <div class="card" style="max-width: 450px; margin: 4rem auto;">
                            <div class="text-center mb-4">
                                <h1 class="text-white" style="font-size: 2rem; margin-bottom: 0.5rem;">R√©initialiser le mot de passe</h1>
                                <p class="text-cyan">R√©cup√©rez l'acc√®s √† votre compte</p>
                            </div>
                            
                            <form id="reset-form">
                                <div class="mb-2">
                                    <label class="text-white mb-1" style="display: block;">Nom d'utilisateur</label>
                                    <input type="text" class="input" id="reset-username" required>
                                </div>
                                
                                <div id="question-container" style="display: none;">
                                    <div class="mb-2">
                                        <label class="text-white mb-1" style="display: block;" id="question-label"></label>
                                        <input type="text" class="input" id="reset-security-answer" required>
                                    </div>
                                </div>
                                
                                <div id="password-container" style="display: none;">
                                    <div class="mb-2">
                                        <label class="text-white mb-1" style="display: block;">Nouveau mot de passe</label>
                                        <input type="password" class="input" id="reset-new-password" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="text-white mb-1" style="display: block;">Confirmer le mot de passe</label>
                                        <input type="password" class="input" id="reset-password-confirm" required>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-warning" style="width: 100%; margin-bottom: 1rem;">R√©initialiser</button>
                                
                                <div class="text-center">
                                    <button type="button" class="btn btn-link" onclick="app.showLogin()">Retour √† la connexion</button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;
            }

            renderDashboard() {
                return `
                    <div class="container">
                        <div class="card">
                            <div class="flex justify-between items-center mb-4">
                                <h1 class="text-white" style="font-size: 2rem;">Bienvenue, ${this.currentUser} üí™</h1>
                                <button class="btn btn-secondary" onclick="app.logout()">D√©connexion</button>
                            </div>

                            <div class="flex gap-2 mb-4" style="overflow-x: auto;">
                                <button class="tab-btn ${this.currentTab === 'dashboard' ? 'active' : ''}" onclick="app.switchTab('dashboard')">üìä Dashboard</button>
                                <button class="tab-btn ${this.currentTab === 'rm' ? 'active' : ''}" onclick="app.switchTab('rm')">üéØ Calculateur 1RM</button>
                                <button class="tab-btn ${this.currentTab === 'sessions' ? 'active' : ''}" onclick="app.switchTab('sessions')">üìù Mes S√©ances</button>
                                <button class="tab-btn ${this.currentTab === 'cours' ? 'active' : ''}" onclick="app.switchTab('cours')">üìö Cours & Ressources</button>
                            </div>

                            ${this.currentTab === 'dashboard' ? this.renderDashboardTab() : ''}
                            ${this.currentTab === 'rm' ? this.renderRMTab() : ''}
                            ${this.currentTab === 'sessions' ? this.renderSessionsTab() : ''}
                            ${this.currentTab === 'cours' ? this.renderCoursTab() : ''}
                        </div>
                    </div>
                `;
            }

            renderDashboardTab() {
                const stats = {
                    total: this.sessions.length,
                    force: this.sessions.filter(s => s.type === 'Force').length,
                    endurance: this.sessions.filter(s => s.type === 'Endurance').length,
                    equilibre: this.sessions.filter(s => s.type === '√âquilibre').length
                };

                return `
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%); border-radius: 1rem; padding: 1.5rem; border: 1px solid rgba(6, 182, 212, 0.3);">
                            <div class="text-cyan" style="font-size: 2.5rem; font-weight: bold;">${stats.total}</div>
                            <div class="text-white" style="opacity: 0.9;">S√©ances cr√©√©es</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(249, 115, 22, 0.2) 0%, rgba(251, 146, 60, 0.2) 100%); border-radius: 1rem; padding: 1.5rem; border: 1px solid rgba(249, 115, 22, 0.3);">
                            <div style="color: #fb923c; font-size: 2.5rem; font-weight: bold;">${stats.force}</div>
                            <div class="text-white" style="opacity: 0.9;">Force</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%); border-radius: 1rem; padding: 1.5rem; border: 1px solid rgba(6, 182, 212, 0.3);">
                            <div class="text-cyan" style="font-size: 2.5rem; font-weight: bold;">${stats.endurance}</div>
                            <div class="text-white" style="opacity: 0.9;">Endurance</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(20, 184, 166, 0.2) 100%); border-radius: 1rem; padding: 1.5rem; border: 1px solid rgba(16, 185, 129, 0.3);">
                            <div style="color: #14b8a6; font-size: 2.5rem; font-weight: bold;">${stats.equilibre}</div>
                            <div class="text-white" style="opacity: 0.9;">√âquilibre</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="text-white" style="font-weight: 600; margin-bottom: 0.5rem;">üí° Conseil du jour</div>
                        <div class="text-white" style="opacity: 0.9;">N'oubliez pas de bien vous √©chauffer avant chaque s√©ance et de vous √©tirer apr√®s. La r√©cup√©ration est aussi importante que l'entra√Ænement !</div>
                    </div>
                `;
            }

            renderRMTab() {
                return `
                    <div>
                        <h2 class="text-white mb-2" style="font-size: 1.5rem;">Calculateur de 1RM</h2>
                        <p class="text-white mb-4" style="opacity: 0.8;">Calculez votre charge maximale sur une r√©p√©tition</p>

                        <form id="rm-form" class="mb-4">
                            <div class="grid grid-cols-2 gap-3 mb-4">
                                <div>
                                    <label class="text-white mb-1" style="display: block;">Charge soulev√©e (kg)</label>
                                    <input type="number" class="input" id="rm-weight" step="0.5" required>
                                </div>
                                <div>
                                    <label class="text-white mb-1" style="display: block;">Nombre de r√©p√©titions</label>
                                    <input type="number" class="input" id="rm-reps" min="1" max="12" required>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Calculer mon 1RM</button>
                        </form>

                        <div id="rm-result" class="hidden"></div>

                        <div class="tip-box">
                            <div class="text-white" style="font-weight: 600; margin-bottom: 0.5rem;">‚ÑπÔ∏è Comment utiliser ce calculateur ?</div>
                            <ul style="list-style: none; padding: 0;">
                                <li class="text-white" style="opacity: 0.9; padding: 0.25rem 0;">‚Ä¢ Entrez une charge que vous pouvez soulever entre 1 et 12 fois</li>
                                <li class="text-white" style="opacity: 0.9; padding: 0.25rem 0;">‚Ä¢ Le calculateur estimera votre 1RM (charge maximale)</li>
                                <li class="text-white" style="opacity: 0.9; padding: 0.25rem 0;">‚Ä¢ Plus pr√©cis entre 3-8 r√©p√©titions</li>
                            </ul>
                        </div>
                    </div>
                `;
            }

            renderSessionsTab() {
                return `
                    <div>
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-white" style="font-size: 1.5rem;">Mes S√©ances d'entra√Ænement</h2>
                            <button class="btn btn-primary" onclick="app.createNewSession()">‚ûï Nouvelle s√©ance</button>
                        </div>

                        ${this.sessions.length === 0 ? `
                            <div class="text-center" style="padding: 3rem 1rem;">
                                <div style="font-size: 4rem; margin-bottom: 1rem;">üìù</div>
                                <p class="text-white" style="font-size: 1.2rem; margin-bottom: 0.5rem;">Aucune s√©ance cr√©√©e</p>
                                <p class="text-white" style="opacity: 0.7;">Commencez par cr√©er votre premi√®re s√©ance d'entra√Ænement</p>
                            </div>
                        ` : `
                            <div>
                                ${this.sessions.map((session, index) => `
                                    <div class="session-card" onclick="app.viewSession(${index})">
                                        <div class="flex justify-between items-center mb-2">
                                            <h3 class="text-white" style="font-size: 1.2rem;">${session.nom}</h3>
                                            <span class="badge badge-${session.type.toLowerCase()}">${session.type}</span>
                                        </div>
                                        <div class="flex gap-2 mb-2" style="flex-wrap: wrap;">
                                            ${session.muscles.map(m => `<span class="badge" style="background: rgba(6, 182, 212, 0.3); color: #67e8f9;">${m}</span>`).join('')}
                                        </div>
                                        <p class="text-white" style="opacity: 0.7; font-size: 0.9rem;">${session.exercices.length} exercice(s)</p>
                                        ${session.circuitAbdos && session.circuitAbdos.active ? '<p class="text-white" style="opacity: 0.7; font-size: 0.9rem;">üî• Circuit abdos inclus</p>' : ''}
                                    </div>
                                `).join('')}
                            </div>
                        `}
                    </div>
                `;
            }

            renderCoursTab() {
                return `
                    <div>
                        <h2 class="text-white mb-4" style="font-size: 1.5rem;">üìö Cours & Ressources P√©dagogiques</h2>
                        
                        <div class="flex gap-2 mb-4" style="overflow-x: auto; padding-bottom: 0.5rem;">
                            <button class="sub-tab-btn ${this.currentCoursTab === 'principes' ? 'active' : ''}" onclick="app.switchCoursTab('principes')">üí° Principes</button>
                            <button class="sub-tab-btn ${this.currentCoursTab === 'pectoraux' ? 'active' : ''}" onclick="app.switchCoursTab('pectoraux')">üí™ Pectoraux</button>
                            <button class="sub-tab-btn ${this.currentCoursTab === 'dos' ? 'active' : ''}" onclick="app.switchCoursTab('dos')">üî∫ Dos</button>
                            <button class="sub-tab-btn ${this.currentCoursTab === 'epaules' ? 'active' : ''}" onclick="app.switchCoursTab('epaules')">üèîÔ∏è √âpaules</button>
                            <button class="sub-tab-btn ${this.currentCoursTab === 'bras' ? 'active' : ''}" onclick="app.switchCoursTab('bras')">üí™ Bras</button>
                            <button class="sub-tab-btn ${this.currentCoursTab === 'jambes' ? 'active' : ''}" onclick="app.switchCoursTab('jambes')">ü¶µ Jambes</button>
                            <button class="sub-tab-btn ${this.currentCoursTab === 'anatomie' ? 'active' : ''}" onclick="app.switchCoursTab('anatomie')">üß¨ Planches Anatomiques</button>
                        </div>

                        ${this.renderCoursContent()}
                    </div>
                `;
            }

            renderCoursContent() {
                if (this.currentCoursTab === 'principes') {
                    return `
                        <div class="content-section">
                            <h3 class="text-cyan mb-4" style="font-size: 1.3rem;">Les Principes Fondamentaux de la Musculation</h3>
                            
                            ${coursData.principes.map(principe => `
                                <div class="exercise-card">
                                    <h4>${principe.titre}</h4>
                                    <p class="text-white" style="opacity: 0.9; margin-bottom: 1rem; line-height: 1.6;">${principe.contenu}</p>
                                    <div class="tip-box" style="margin-top: 1rem;">
                                        <div class="text-white" style="font-weight: 600; margin-bottom: 0.5rem;">‚ú® Conseils pratiques :</div>
                                        <ul>
                                            ${principe.conseils.map(conseil => `<li>${conseil}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else if (this.currentCoursTab === 'pectoraux') {
                    return this.renderExercicesSection(coursData.exercicesPectoraux, 'Pectoraux');
                } else if (this.currentCoursTab === 'dos') {
                    return this.renderExercicesSection(coursData.exercicesDos, 'Dos');
                } else if (this.currentCoursTab === 'epaules') {
                    return this.renderExercicesSection(coursData.exercicesEpaules, '√âpaules');
                } else if (this.currentCoursTab === 'bras') {
                    return this.renderExercicesSection(coursData.exercicesBras, 'Bras');
                } else if (this.currentCoursTab === 'jambes') {
                    return this.renderExercicesSection(coursData.exercicesJambes, 'Jambes');
                } else if (this.currentCoursTab === 'anatomie') {
                    return this.renderAnatomieSection();
                }
            }

            renderExercicesSection(exercices, titre) {
                return `
                    <div class="content-section">
                        <h3 class="text-cyan mb-4" style="font-size: 1.3rem;">Exercices pour les ${titre}</h3>
                        
                        ${exercices.map(ex => `
                            <div class="exercise-card">
                                <h4>${ex.nom}</h4>
                                <p class="text-white" style="opacity: 0.9; margin-bottom: 1rem; font-style: italic;">${ex.description}</p>
                                
                                <div style="margin-bottom: 1rem;">
                                    <div class="text-white" style="font-weight: 600; margin-bottom: 0.5rem; color: #10b981;">üéØ Technique d'ex√©cution :</div>
                                    <ul>
                                        ${ex.technique.map(step => `<li>${step}</li>`).join('')}
                                    </ul>
                                </div>
                                
                                ${ex.variantes ? `
                                    <div class="tip-box">
                                        <div class="text-white" style="font-weight: 600; margin-bottom: 0.5rem;">üîÑ Variantes :</div>
                                        <p class="text-white" style="opacity: 0.9;">${ex.variantes.join(' ‚Ä¢ ')}</p>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            renderAnatomieSection() {
                return `
                    <div class="content-section">
                        <h3 class="text-cyan mb-4" style="font-size: 1.3rem;">üß¨ Planches Anatomiques</h3>
                        
                        <div class="grid grid-cols-2 gap-3 mb-4">
                            <div class="anatomy-image-container">
                                <img src="https://github.com/BastianMAS/livret-musculation-cap/blob/main/images/planche%20anatomique%20face.PNG?raw=true" alt="Planche anatomique dos">
                                <p class="text-white" style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem;">Vue de dos</p>
                            </div>
                            
                            <div class="anatomy-image-container">
                                <img src="https://github.com/BastianMAS/livret-musculation-cap/blob/main/images/planche%20anatomique%20face.PNG?raw=true" alt="Planche anatomique face">
                                <p class="text-white" style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem;">Vue de face</p>
                            </div>
                        </div>

                        <h3 class="text-cyan mb-3" style="font-size: 1.2rem; margin-top: 2rem;">üìñ Anatomie Musculaire D√©taill√©e</h3>
                        
                        ${this.musclesList.map(muscle => {
                            const info = coursData.anatomie[muscle];
                            return `
                                <div class="muscle-info-card">
                                    <h4>üí™ ${muscle}</h4>
                                    
                                    <div class="muscle-info-section">
                                        <h5>üéØ R√¥le et fonction</h5>
                                        <p>${info.role}</p>
                                    </div>
                                    
                                    <div class="muscle-info-section">
                                        <h5>üîó Insertions anatomiques</h5>
                                        <ul>
                                            ${info.insertions.map(insertion => `<li>${insertion}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }

            switchCoursTab(tab) {
                this.currentCoursTab = tab;
                this.render();
            }handleLogin(e) {
                e.preventDefault();
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;

                const userKey = `user-${username}`;
                const userResult = storage.get(userKey, true);

                if (!userResult.exists) {
                    alert('Nom d\'utilisateur incorrect');
                    return;
                }

                const userData = JSON.parse(userResult.value);
                if (userData.password !== password) {
                    alert('Mot de passe incorrect');
                    return;
                }

                this.currentUser = username;
                this.currentView = 'dashboard';
                this.loadSessions();
                this.render();
            }

            handleSignup(e) {
                e.preventDefault();
                const username = document.getElementById('signup-username').value;
                const password = document.getElementById('signup-password').value;
                const passwordConfirm = document.getElementById('signup-password-confirm').value;
                const securityQuestion = document.getElementById('signup-security-question').value;
                const securityAnswer = document.getElementById('signup-security-answer').value;

                if (password !== passwordConfirm) {
                    alert('Les mots de passe ne correspondent pas');
                    return;
                }

                const userKey = `user-${username}`;
                const userResult = storage.get(userKey, true);

                if (userResult.exists) {
                    alert('Ce nom d\'utilisateur existe d√©j√†');
                    return;
                }

                const userData = {
                    password: password,
                    securityQuestion: securityQuestion,
                    securityAnswer: securityAnswer.toLowerCase()
                };

                storage.save(userKey, userData, true);
                alert('Compte cr√©√© avec succ√®s !');
                this.showLogin();
            }

            handlePasswordReset(e) {
                e.preventDefault();
                const username = document.getElementById('reset-username').value;
                const securityAnswer = document.getElementById('reset-security-answer').value;
                const newPassword = document.getElementById('reset-new-password').value;
                const passwordConfirm = document.getElementById('reset-password-confirm').value;

                if (newPassword !== passwordConfirm) {
                    alert('Les mots de passe ne correspondent pas');
                    return;
                }

                const userKey = `user-${username}`;
                const userResult = storage.get(userKey, true);

                if (!userResult.exists) {
                    alert('Nom d\'utilisateur incorrect');
                    return;
                }

                const userData = JSON.parse(userResult.value);
                if (userData.securityAnswer !== securityAnswer.toLowerCase()) {
                    alert('R√©ponse de s√©curit√© incorrecte');
                    return;
                }

                userData.password = newPassword;
                storage.save(userKey, userData, true);
                alert('Mot de passe r√©initialis√© avec succ√®s !');
                this.showLogin();
            }

            showLogin() {
                this.currentView = 'login';
                this.render();
            }

            showSignup() {
                this.currentView = 'signup';
                this.render();
            }

            showPasswordReset() {
                this.currentView = 'reset';
                this.render();
            }

            logout() {
                this.currentUser = null;
                this.sessions = [];
                this.currentView = 'login';
                this.render();
            }

            switchTab(tab) {
                this.currentTab = tab;
                this.render();
            }

            calculateRM(e) {
                e.preventDefault();
                const weight = parseFloat(document.getElementById('rm-weight').value);
                const reps = parseInt(document.getElementById('rm-reps').value);

                const rm = weight * (1 + reps / 30);
                
                const resultDiv = document.getElementById('rm-result');
                resultDiv.classList.remove('hidden');
                resultDiv.innerHTML = `
                    <div class="rm-result">
                        <div class="text-white" style="font-size: 1.2rem; opacity: 0.9; margin-bottom: 0.5rem;">Votre 1RM estim√©</div>
                        <div style="font-size: 3rem; font-weight: bold; color: #10b981; margin-bottom: 1rem;">${rm.toFixed(1)} kg</div>
                        <div class="text-white" style="opacity: 0.8;">Bas√© sur ${weight}kg √ó ${reps} r√©p√©tition${reps > 1 ? 's' : ''}</div>
                    </div>
                `;
            }

            createNewSession() {
                this.currentSession = null;
                this.currentView = 'session-form';
                this.render();
            }

            editSession(index) {
                this.currentSession = index;
                this.currentView = 'session-form';
                this.render();
            }

            viewSession(index) {
                this.currentSession = index;
                this.currentView = 'session-detail';
                this.render();
            }

            cancelSession() {
                this.currentSession = null;
                this.currentView = 'dashboard';
                this.currentTab = 'sessions';
                this.render();
            }

            backToSessions() {
                this.currentSession = null;
                this.currentView = 'dashboard';
                this.currentTab = 'sessions';
                this.render();
            }

            renderSessionForm() {
                return `<div class="container"><div class="card"><h2 class="text-white mb-4">Cr√©er une s√©ance</h2><p class="text-white">Fonctionnalit√© en cours de d√©veloppement...</p><button class="btn btn-secondary" onclick="app.backToSessions()">Retour</button></div></div>`;
            }

            renderSessionDetail() {
                const session = this.sessions[this.currentSession];
                return `
                    <div class="container">
                        <div class="card">
                            <div class="flex justify-between items-center mb-4">
                                <div>
                                    <h1 class="text-white mb-2" style="font-size: 2rem;">${session.nom}</h1>
                                    <span class="badge badge-${session.type.toLowerCase()}">${session.type}</span>
                                </div>
                                <button class="btn btn-secondary" onclick="app.backToSessions()">‚Üê Retour</button>
                            </div>

                            <div class="mb-4">
                                <h3 class="text-cyan mb-2">Muscles cibl√©s</h3>
                                <div class="flex gap-2" style="flex-wrap: wrap;">
                                    ${session.muscles.map(m => `<span class="badge" style="background: rgba(6, 182, 212, 0.3); color: #67e8f9;">${m}</span>`).join('')}
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="text-cyan mb-2">Exercices (${session.exercices.length})</h3>
                                ${session.exercices.map((ex, i) => `
                                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 0.75rem; padding: 1.25rem; margin-bottom: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.2);">
                                        <div class="flex justify-between items-center mb-2">
                                            <h4 class="text-white" style="font-size: 1.1rem;">${i + 1}. ${ex.nom}</h4>
                                        </div>
                                        <div class="grid grid-cols-3 gap-3">
                                            <div>
                                                <div class="text-cyan" style="font-size: 0.85rem;">S√©ries</div>
                                                <div class="text-white" style="font-size: 1.2rem; font-weight: 600;">${ex.series}</div>
                                            </div>
                                            <div>
                                                <div class="text-cyan" style="font-size: 0.85rem;">R√©p√©titions</div>
                                                <div class="text-white" style="font-size: 1.2rem; font-weight: 600;">${ex.repetitions}</div>
                                            </div>
                                            <div>
                                                <div class="text-cyan" style="font-size: 0.85rem;">Charge</div>
                                                <div class="text-white" style="font-size: 1.2rem; font-weight: 600;">${ex.charge}</div>
                                            </div>
                                        </div>
                                        ${ex.repos ? `<div class="text-white mt-2" style="opacity: 0.8; font-size: 0.9rem;">‚è±Ô∏è Repos : ${ex.repos}</div>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            attachLoginEvents() {
                const loginForm = document.getElementById('login-form');
                const signupForm = document.getElementById('signup-form');
                
                if (loginForm) {
                    loginForm.addEventListener('submit', (e) => this.handleLogin(e));
                }
                
                if (signupForm) {
                    signupForm.addEventListener('submit', (e) => this.handleSignup(e));
                }
            }

            attachResetEvents() {
                const resetForm = document.getElementById('reset-form');
                const usernameInput = document.getElementById('reset-username');
                
                if (usernameInput) {
                    usernameInput.addEventListener('blur', () => {
                        const username = usernameInput.value;
                        if (username) {
                            const userKey = `user-${username}`;
                            const userResult = storage.get(userKey, true);
                            
                            if (userResult.exists) {
                                const userData = JSON.parse(userResult.value);
                                const questionContainer = document.getElementById('question-container');
                                const questionLabel = document.getElementById('question-label');
                                const passwordContainer = document.getElementById('password-container');
                                
                                questionLabel.textContent = securityQuestions[userData.securityQuestion];
                                questionContainer.style.display = 'block';
                                passwordContainer.style.display = 'block';
                            }
                        }
                    });
                }
                
                if (resetForm) {
                    resetForm.addEventListener('submit', (e) => this.handlePasswordReset(e));
                }
            }

            attachDashboardEvents() {
                const rmForm = document.getElementById('rm-form');
                if (rmForm) {
                    rmForm.addEventListener('submit', (e) => this.calculateRM(e));
                }
            }

            attachSessionFormEvents() {
                // Simplifi√© pour cette version
            }
        }

        const app = new LivretApp();
    </script>
</body>
</html>